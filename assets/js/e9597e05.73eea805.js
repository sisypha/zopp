"use strict";(globalThis.webpackChunkzopp_docs=globalThis.webpackChunkzopp_docs||[]).push([[4594],{5433(e,n,i){i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>a,frontMatter:()=>l,metadata:()=>r,toc:()=>h});const r=JSON.parse('{"id":"security/cryptography","title":"Cryptographic Primitives","description":"Cryptographic algorithms used by zopp.","source":"@site/docs/security/cryptography.md","sourceDirName":"security","slug":"/security/cryptography","permalink":"/zopp/security/cryptography","draft":false,"unlisted":false,"editUrl":"https://github.com/faiscadev/zopp/tree/main/docs/docs/security/cryptography.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"Cryptographic Primitives","description":"Cryptographic algorithms used by zopp."},"sidebar":"docs","previous":{"title":"Security Architecture","permalink":"/zopp/security/architecture"}}');var s=i(4848),t=i(8453);const l={sidebar_position:3,title:"Cryptographic Primitives",description:"Cryptographic algorithms used by zopp."},d="Cryptographic Primitives",c={},h=[{value:"Algorithms",id:"algorithms",level:2},{value:"XChaCha20-Poly1305",id:"xchacha20-poly1305",level:2},{value:"X25519 ECDH",id:"x25519-ecdh",level:2},{value:"Ed25519",id:"ed25519",level:2},{value:"HKDF-SHA256",id:"hkdf-sha256",level:2},{value:"Argon2id",id:"argon2id",level:2},{value:"Random Number Generation",id:"random-number-generation",level:2},{value:"Memory Safety",id:"memory-safety",level:2},{value:"Implementation Notes",id:"implementation-notes",level:2},{value:"Audit Status",id:"audit-status",level:2},{value:"Future Considerations",id:"future-considerations",level:2},{value:"Post-Quantum Cryptography",id:"post-quantum-cryptography",level:3},{value:"Next Steps",id:"next-steps",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"cryptographic-primitives",children:"Cryptographic Primitives"})}),"\n",(0,s.jsx)(n.p,{children:"This page details the cryptographic algorithms used by zopp."}),"\n",(0,s.jsx)(n.h2,{id:"algorithms",children:"Algorithms"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Purpose"}),(0,s.jsx)(n.th,{children:"Algorithm"}),(0,s.jsx)(n.th,{children:"Library"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Symmetric encryption"}),(0,s.jsx)(n.td,{children:"XChaCha20-Poly1305"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"chacha20poly1305"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Key agreement"}),(0,s.jsx)(n.td,{children:"X25519 ECDH"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"x25519-dalek"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Signing"}),(0,s.jsx)(n.td,{children:"Ed25519"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ed25519-dalek"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Key derivation"}),(0,s.jsx)(n.td,{children:"HKDF-SHA256"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"hkdf"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Password hashing"}),(0,s.jsx)(n.td,{children:"Argon2id"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"argon2"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Random"}),(0,s.jsx)(n.td,{children:"CSPRNG"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"rand"})," (OS entropy)"]})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"xchacha20-poly1305",children:"XChaCha20-Poly1305"}),"\n",(0,s.jsx)(n.p,{children:"Used for encrypting secrets and wrapping keys."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Properties:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"256-bit key"}),"\n",(0,s.jsx)(n.li,{children:"192-bit nonce (extended nonce allows random generation)"}),"\n",(0,s.jsx)(n.li,{children:"AEAD (authenticated encryption with associated data)"}),"\n",(0,s.jsx)(n.li,{children:"Constant-time implementation"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Why XChaCha20 over AES-GCM:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Larger nonce prevents collisions with random generation"}),"\n",(0,s.jsx)(n.li,{children:"No hardware timing side channels"}),"\n",(0,s.jsx)(n.li,{children:"Simpler to implement correctly"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"x25519-ecdh",children:"X25519 ECDH"}),"\n",(0,s.jsx)(n.p,{children:"Used for key agreement when wrapping KEKs."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Properties:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Curve25519 elliptic curve"}),"\n",(0,s.jsx)(n.li,{children:"256-bit keys"}),"\n",(0,s.jsx)(n.li,{children:"Constant-time implementation"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Key wrapping process:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'shared_secret = X25519(my_private, their_public)\nwrap_key = HKDF-SHA256(shared_secret, info="zopp-kek-wrap", length=32)\nwrapped = XChaCha20-Poly1305(wrap_key, kek)\n'})}),"\n",(0,s.jsx)(n.h2,{id:"ed25519",children:"Ed25519"}),"\n",(0,s.jsx)(n.p,{children:"Used for request signing and authentication."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Properties:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Edwards curve (Ed25519)"}),"\n",(0,s.jsx)(n.li,{children:"256-bit keys"}),"\n",(0,s.jsx)(n.li,{children:"512-bit signatures"}),"\n",(0,s.jsx)(n.li,{children:"Deterministic signatures"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Usage:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Principals sign all API requests"}),"\n",(0,s.jsx)(n.li,{children:"Server verifies signatures for authentication"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"hkdf-sha256",children:"HKDF-SHA256"}),"\n",(0,s.jsx)(n.p,{children:"Used for deriving encryption keys from shared secrets."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Hash: SHA-256"}),"\n",(0,s.jsx)(n.li,{children:"Salt: None (using IKM directly)"}),"\n",(0,s.jsx)(n.li,{children:"Info: Context-specific string"}),"\n",(0,s.jsx)(n.li,{children:"Output: 32 bytes"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"argon2id",children:"Argon2id"}),"\n",(0,s.jsx)(n.p,{children:"Used for password-derived keys (future feature)."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Memory: 64 MiB"}),"\n",(0,s.jsx)(n.li,{children:"Iterations: 3"}),"\n",(0,s.jsx)(n.li,{children:"Parallelism: 4"}),"\n",(0,s.jsx)(n.li,{children:"Output: 32 bytes"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"random-number-generation",children:"Random Number Generation"}),"\n",(0,s.jsx)(n.p,{children:"All randomness uses the operating system's CSPRNG:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Linux: ",(0,s.jsx)(n.code,{children:"getrandom()"})]}),"\n",(0,s.jsxs)(n.li,{children:["macOS: ",(0,s.jsx)(n.code,{children:"SecRandomCopyBytes()"})]}),"\n",(0,s.jsxs)(n.li,{children:["Windows: ",(0,s.jsx)(n.code,{children:"BCryptGenRandom()"})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"memory-safety",children:"Memory Safety"}),"\n",(0,s.jsx)(n.p,{children:"Sensitive data is handled carefully:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Keys use ",(0,s.jsx)(n.code,{children:"zeroize"})," crate for secure erasure"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"ZeroizeOnDrop"})," trait ensures cleanup"]}),"\n",(0,s.jsx)(n.li,{children:"No logging of sensitive values"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"implementation-notes",children:"Implementation Notes"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"No custom crypto"}),": All primitives from well-audited Rust crates"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"No compression before encryption"}),": Prevents CRIME-style attacks"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Constant-time comparisons"}),": For signature verification"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Explicit key types"}),": Prevents key confusion attacks"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"audit-status",children:"Audit Status"}),"\n",(0,s.jsx)(n.p,{children:"zopp has not yet undergone a formal security audit. The cryptographic design follows established best practices and uses standard, well-audited libraries."}),"\n",(0,s.jsx)(n.h2,{id:"future-considerations",children:"Future Considerations"}),"\n",(0,s.jsx)(n.h3,{id:"post-quantum-cryptography",children:"Post-Quantum Cryptography"}),"\n",(0,s.jsx)(n.p,{children:"Current algorithms (Ed25519, X25519) are vulnerable to quantum computers. When PQC standards mature:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Key encapsulation: ML-KEM (Kyber)"}),"\n",(0,s.jsx)(n.li,{children:"Signatures: ML-DSA (Dilithium) or SLH-DSA (SPHINCS+)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"zopp's architecture allows upgrading algorithms without changing the security model."}),"\n",(0,s.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/security/architecture",children:"Architecture"})," - How these primitives are used"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/self-hosting",children:"Self-Hosting"})," - Production deployment"]}),"\n"]})]})}function a(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},8453(e,n,i){i.d(n,{R:()=>l,x:()=>d});var r=i(6540);const s={},t=r.createContext(s);function l(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);